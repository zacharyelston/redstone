# Redstone Service Template for Release.com
# Following the "Built for Clarity" design philosophy

# This template defines a Helm-based service configuration for Release.com
service:
  name: ${SERVICE_NAME}
  description: ${SERVICE_DESCRIPTION}
  
# Helm values for the service
helm:
  values:
    ${SERVICE_NAME}:
      enabled: true
      replicaCount: ${REPLICAS:-1}
      service:
        type: ${SERVICE_TYPE:-ClusterIP}
        port: ${SERVICE_PORT:-8080}
      image:
        repository: ${SERVICE_IMAGE}
        tag: ${SERVICE_TAG:-latest}
        pullPolicy: IfNotPresent
      
      # Resource requirements
      resources:
        requests:
          cpu: ${SERVICE_CPU_REQUEST:-100m}
          memory: ${SERVICE_MEMORY_REQUEST:-128Mi}
        limits:
          cpu: ${SERVICE_CPU_LIMIT:-500m}
          memory: ${SERVICE_MEMORY_LIMIT:-256Mi}
          
      # Environment variables
      env:
        - name: SERVICE_ENV_VAR1
          value: ${SERVICE_ENV_VAR1_VALUE}
        - name: SERVICE_ENV_VAR2
          valueFrom:
            secretKeyRef:
              name: ${SERVICE_NAME}-secrets
              key: env-var2
      # Health checks
      livenessProbe:
        httpGet:
          path: ${HEALTH_CHECK_PATH:-/health}
          port: ${HEALTH_CHECK_PORT:-8080}
        initialDelaySeconds: ${LIVENESS_INITIAL_DELAY:-30}
        periodSeconds: ${LIVENESS_PERIOD:-10}
        
      readinessProbe:
        httpGet:
          path: ${READINESS_CHECK_PATH:-/ready}
          port: ${READINESS_CHECK_PORT:-8080}
        initialDelaySeconds: ${READINESS_INITIAL_DELAY:-15}
        periodSeconds: ${READINESS_PERIOD:-5}
        
      # Persistence configuration
      persistence:
        enabled: ${PERSISTENCE_ENABLED:-false}
        size: ${STORAGE_SIZE:-1Gi}
        
      # Ingress configuration
      ingress:
        enabled: ${INGRESS_ENABLED:-false}
        ingressClassName: nginx
        hosts:
          - host: ${INGRESS_HOST}
            paths:
              - path: ${INGRESS_PATH:-/}
                pathType: Prefix
